<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>eda.knit</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.26/datatables.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ChemStat-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="getting-started-with-r.html">Getting Started with R</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Essential of The R Language
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="essential-of-r-language.html">Table of Content</a>
    </li>
    <li>
      <a href="intoduction-to-use-r.html">Introduction to Using R</a>
    </li>
    <li>
      <a href="r-data-input-and-type.html">Importing/Exporting Data into R</a>
    </li>
    <li>
      <a href="data-wrangling.html">Data Wrangling</a>
    </li>
    <li>
      <a href="eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="stat_test.html">Statistical Test</a>
    </li>
    <li>
      <a href="anova.html">Analysis of Variance (ANOVA)</a>
    </li>
    <li>
      <a href="correlation.html">Correlation Analysis</a>
    </li>
    <li>
      <a href="regression.html">Regression Analysis</a>
    </li>
    <li>
      <a href="stepwise-regression.html">Stepwise Regression</a>
    </li>
    <li>
      <a href="non-linear-regression.html">Nonlinear Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Cheminformatics with R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cheminformatics-with-r.html">Table of Content</a>
    </li>
    <li>
      <a href="getting-strated-chem.html">Getting Started</a>
    </li>
    <li>
      <a href="cheminformatics-with-chemminer.html">Cheminformatics with ChemmineR</a>
    </li>
    <li>
      <a href="cheminformatics-with-cdk.html">Cheminformatics with CDK</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ICP-MS Data Processing with R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="icp-ms-data-processing-and-analysis-with-r.html">Table of Content</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:zia207@gmail.com">
    <span class="fa fa-envelope fa-lg"></span>
     
    Email
  </a>
</li>
<li>
  <a href="http://github.com/zia207">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/zia-ahmed-a7653578">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div style="margin-bottom:20px;">

</div>
<img src="Image/PNG_FILE_02/eda.png" width="100%" style="display: block; margin: auto;" />
<div style="margin-bottom:20px;">

</div>
<div id="table-of-content" class="section level3">
<h3><strong>Table of Content</strong></h3>
<ul>
<li><p><a href="#load-library">Load Library</a></p></li>
<li><p><a href="#load-data">Load Data</a></p></li>
<li><p><a href="#exploratory-data-analysis">Exploratory Data
Analysis</a></p></li>
<li><p><a href="#data-quality-diagnosis">Data Quality Diagnosis</a></p>
<ul>
<li><p><a href="#diagnosis-of-numeric-variables">Diagnosis of Numeric
Variables</a></p></li>
<li><p><a href="#diagnosis-of-categorical-variables">Diagnosis of
Categorical Variables</a></p></li>
<li><p><a href="#diagnosing-outliers">Diagnosing Outliers</a></p></li>
<li><p><a href="#visualization-of-outliers">Visualization of
Outliers</a></p></li>
</ul></li>
<li><p><a href="#data-distribution">Data Distribution</a></p>
<ul>
<li><p><a href="#probabilitya-distribution">Probability
Distribution</a></p></li>
<li><p><a href="#normal-distribution">Normal Distribution</a></p></li>
<li><p><a href="#visual-inspection-of-normal-distribution">Visual
Inspection of Normal Distribution</a></p>
<ul>
<li><p><a href="#histogram">Histogram</a></p></li>
<li><p><a href="#kernel-density-plots">Kernel Density Plots</a></p></li>
<li><p><a href="#quantile-quantile-plots">Quantile-Quantile
Plots</a></p></li>
<li><p><a
href="#visualization-ofnormality-using-dlookr-Package">Visualization of
Normality using dlookr Package</a></p></li>
</ul></li>
<li><p><a href="#normality-test">Normality Test</a></p></li>
<li><p><a href="#test-of-normality-using-dlookr-package">Test of
Normality using dlookr Package</a></p></li>
<li><p><a href="#measures-of-skewness-and-kurtosis">Measures of Skewness
and Kurtosis</a></p></li>
<li><p><a href="#test-of-normality-using-dlookr-package">Test of
Normality using dlookr Package</a></p></li>
</ul></li>
<li><p><a href="#data-transforamtion-fornormality">Data Transformation
for Normality</a></p>
<ul>
<li><p><a href="#data-transformation-methods">Data Transformation
Methods</a></p></li>
<li><p><a href="#power-transformation">Power Transformation</a></p></li>
</ul></li>
<li><p><a href="#descriptive-statistics">Descriptive
Statistics</a></p></li>
<li><p><a href="#boxplots">Boxplots</a></p>
<ul>
<li><p><a href="#grouped-boxplots">Grouped Boxplots</a></p></li>
<li><p><a href="#boxplots-with-Jitters">Boxplots with
Jitter</a>]</p></li>
</ul></li>
<li><p>[Barplot](#(barplot)</p>
<ul>
<li><p><a href="barplot-with-error-bars">Barplot with Error
Bars</a></p></li>
<li><p><a href="#grouped-barplot-with-error-bars">Grouped Barplot with
Error Bars</a></p></li>
<li><p><a href="#stacked-barplot">Stacked Barplot</a></p></li>
</ul></li>
<li><p><a href="#grouped-density-plot">Grouped Density Plot</a></p></li>
</ul>
<div style="margin-bottom:30px;">

</div>
</div>
<div id="load-library" class="section level3">
<h3><strong>Load Library</strong></h3>
<p>In this exercise We will use following R-packages:</p>
<pre class="r"><code># load library
library(tidyverse)
library(dlookr)
library(moments)
library(car)
library(plyr)
library(data.table)
library(DT)
library(Hmisc)
library(corrplot) 
library(corrr)
library(gridExtra)
library(ggExtra)
library(BSDA)
library(GGally)
library(agricolae) 
library(multcomp)
library(multcompView)
library(ggfortify)</code></pre>
<div style="margin-bottom:30px;">

</div>
</div>
<div id="import-data" class="section level3">
<h3><strong>Import Data</strong></h3>
<p>In this excersise, we use following data set:</p>
<p><strong>water_soil_rice_arsenic_data.csv</strong>: Arsenic (As) data
in irrigation water, paddy soil and and rice grain in a contaminated
cites from Bangladesh</p>
<p>We import this data using <strong>read_csv()</strong> from
<strong>readr</strong> package.</p>
<pre class="r"><code># define working directory
dataFolder&lt;-&quot;E:/Dropbox/GitHub/chemstat-r-github.io/Data/&quot;
df&lt;-readr::read_csv(paste0(dataFolder,&quot;water_soil_rice_arsenic_data.csv&quot;))</code></pre>
<div style="margin-bottom:30px;">

</div>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2><strong>Exploratory Data Analysis</strong></h2>
<p><strong>Exploratory data analysis (EDA)</strong> involves using
graphics and visualizations to explore and analyze a data set. The goal
is to explore, investigate and learn, as opposed to confirming
statistical hypotheses.</p>
<div style="margin-bottom:15px;">

</div>
<div id="data-quality-diagnosis" class="section level3">
<h3><strong>Data Quality Diagnosis</strong></h3>
<p>In this exercise we will use arsenic data in irrigation water, soil
and rice which could be found <a
href="https://www.dropbox.com/s/1gojx95huzgnibc/water_soil_rice_arsenic_data.csv?dl=0">here</a></p>
<p>Data Quality Diagnosis is the first step before any statistical
analysis. We use <strong>diagnose()</strong> function of
<strong>dlookr</strong> package to use to explore following:</p>
<ul>
<li><p>variables : variable names</p></li>
<li><p>types : the data type of the variables</p></li>
<li><p>missing_count : number of missing values</p></li>
<li><p>missing_percent : percentage of missing values</p></li>
<li><p>unique_count : number of unique values</p></li>
<li><p>unique_rate : rate of unique value. unique_count / number of
observation</p></li>
</ul>
<pre class="r"><code>dlookr::diagnose(df, SAs, WAs, Grain_As) # Only soil,  water and rice grain AS</code></pre>
<pre><code>## # A tibble: 3 × 6
##   variables types   missing_count missing_percent unique_count unique_rate
##   &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
## 1 SAs       numeric             0               0          174       0.662
## 2 WAs       numeric             0               0          167       0.635
## 3 Grain_As  numeric             0               0          197       0.749</code></pre>
<div style="margin-bottom:15px;">

</div>
<div id="diagnosis-of-numeric-variables" class="section level4">
<h4><strong>Diagnosis of Numeric Variables</strong></h4>
<p>We may use <strong>diagnose_numeric()</strong>, diagnoses
numeric(continuous and discrete) variables in a data frame returns more
diagnostic information such as:</p>
<ul>
<li><p>min : minimum value</p></li>
<li><p>Q1 : 1/4 quartile, 25th percentile</p></li>
<li><p>mean : arithmetic mean</p></li>
<li><p>median : median, 50th percentile</p></li>
<li><p>Q3 : 3/4 quartile, 75th percentile</p></li>
<li><p>max : maximum value</p></li>
<li><p>zero : number of observations with a value of 0</p></li>
<li><p>minus : number of observations with negative numbers</p></li>
<li><p>outlier : number of outliers</p></li>
</ul>
<pre class="r"><code># diagnose_numeric(df) # all data
dlookr::diagnose_numeric(df, SAs, WAs, Grain_As) # only three variables</code></pre>
<pre><code>## # A tibble: 3 × 10
##   variables   min      Q1   mean median     Q3    max  zero minus outlier
## * &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
## 1 SAs       4.7   12.7    17.9   17.2   22.0   51.8       0     0       4
## 2 WAs       0.011  0.0745  0.130  0.119  0.175  0.458     0     0       7
## 3 Grain_As  0.094  0.245   0.326  0.313  0.385  0.845     0     0       7</code></pre>
<div style="margin-bottom:15px;">

</div>
</div>
<div id="diagnosis-of-categorical-variables" class="section level4">
<h4><strong>Diagnosis of Categorical Variables</strong></h4>
<p><strong>diagnose_category()</strong> diagnoses the
categorical(factor, ordered, character) variables of a data frame. The
usage is similar to diagnose() but returns more diagnostic information
such as:</p>
<ul>
<li><p>variables : variable names</p></li>
<li><p>levels: level names</p></li>
<li><p>N : number of observation</p></li>
<li><p>freq : number of observation at the levels</p></li>
<li><p>ratio : percentage of observation at the levels</p></li>
<li><p>rank : rank of occupancy ratio of levels</p></li>
</ul>
<pre class="r"><code>dlookr::diagnose_category(df, Variety, Land_type)</code></pre>
<pre><code>## # A tibble: 8 × 6
##   variables levels       N  freq ratio  rank
##   &lt;chr&gt;     &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1 Variety   BR28       263    84 31.9      1
## 2 Variety   IET        263    81 30.8      2
## 3 Variety   Purbachi   263    38 14.4      3
## 4 Variety   Ratna      263    34 12.9      4
## 5 Variety   Minikate   263    19  7.22     5
## 6 Variety   BR29       263     7  2.66     6
## 7 Land_type MHL        263   141 53.6      1
## 8 Land_type HL         263   122 46.4      2</code></pre>
<div style="margin-bottom:15px;">

</div>
</div>
<div id="diagnosing-outliers" class="section level4">
<h4><strong>Diagnosing Outliers</strong></h4>
<p>diagnose_outlier() diagnoses the outliers of the numeric (continuous
and discrete) variables of the data frame.</p>
<ul>
<li><p>outliers_cnt : number of outliers</p></li>
<li><p>outliers_ratio : percent of outliers</p></li>
<li><p>outliers_mean : arithmetic average of outliers</p></li>
<li><p>with_mean : arithmetic average of with outliers</p></li>
<li><p>without_mean : arithmetic average of without outliers</p></li>
</ul>
<pre class="r"><code>dlookr::diagnose_outlier(df, SAs, WAs, Grain_As )</code></pre>
<pre><code>## # A tibble: 3 × 6
##   variables outliers_cnt outliers_ratio outliers_mean with_mean without_mean
## * &lt;chr&gt;            &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1 SAs                  4           1.52        49.0      17.9         17.4  
## 2 WAs                  7           2.66         0.379     0.130        0.123
## 3 Grain_As             7           2.66         0.727     0.326        0.315</code></pre>
</div>
<div id="visualization-of-outliers" class="section level4">
<h4><strong>Visualization of Outliers</strong></h4>
<p><strong>plot_outlier()</strong> visualizes outliers of numerical
variables(continuous and discrete) of data.frame. Usage is the same
diagnose().</p>
<p>The plot derived from the numerical data diagnosis is as follows.</p>
<ul>
<li><p>With outliers box plot</p></li>
<li><p>Without outliers box plot</p></li>
<li><p>With outliers histogram</p></li>
<li><p>Without outliers histogram</p></li>
</ul>
<p>The following example uses diagnose_outlier(), plot_outlier(), and
dplyr packages to visualize all numerical variables with an outlier
ratio of 0.5% or higher.</p>
<pre class="r"><code>df %&gt;%
  dlookr::plot_outlier(dlookr::diagnose_outlier(df, SAs) %&gt;% 
                 dplyr::filter(outliers_ratio &gt;= 0.5) %&gt;% 
                 dplyr::select(variables) %&gt;% 
                 unlist())</code></pre>
<p><img src="eda_files/figure-html/Visualization%20of%20Outliers-1.png" width="672" /></p>
</div>
</div>
<div id="data-distribution" class="section level3">
<h3><strong>Data Distribution</strong></h3>
<div id="probability-distribution" class="section level4">
<h4><strong>Probability Distribution</strong></h4>
<p>A statistical distribution, or probability distribution, describes
all the possible values and likelihoods that a random variable (a random
variable is a variable whose value is unknown or a function that assigns
values to each of an experiment’s outcomes) can take within a given
range. This range will be bounded between the minimum and maximum
possible values, but precisely where the possible value is likely to be
plotted on the probability distribution depends on a number of factors.
These factors include the distribution’s <strong>mean
(average)</strong>, <strong>standard deviation</strong>,
<strong>skewness</strong>, and <strong>kurtosis</strong> <a
href="https://www.investopedia.com/terms/p/probabilitydistribution.asp">(Source)</a>..</p>
<p>In probability theory and statistics, a probability distribution is
the mathematical function that gives the probabilities of occurrence of
different possible outcomes for an experiment.It is a mathematical
description of a random phenomenon in terms of its sample space and the
probabilities of events (subsets of the sample space).<a
href="https://en.wikipedia.org/wiki/Probability_distribution">(Wikipedia)</a>.</p>
<p><strong>Probability Density function (PDF)</strong> is a statistical
expression that defines a probability distribution (the likelihood of an
outcome) for a discrete random variable (e.g., a stock or ETF) as
opposed to a continuous random variable.</p>
<p>The <strong>normal distribution</strong> is a common example of a
PDF, forming the well-known <strong>bell curve</strong> shape. It is
also known as the <strong>Gaussian distribution</strong>, is a
probability distribution that is symmetric about the mean, showing that
data near the mean are more frequent in occurrence than data far from
the mean.</p>
<p>The mean and standard deviation can be related to the Gaussian
distribution - that gives the probability of observing a particular
value of x. For a finite number of measurements, the Gaussian
distribution can be approximated as:</p>
<p><a href="https://rpubs.com/dgosser/802164"
class="uri">https://rpubs.com/dgosser/802164</a></p>
<p><img src="Image/PNG_FILE_02/gussian_distrubution.png" width="40%" style="display: block; margin: auto auto auto 0;" /></p>
<p>Suppose, a non-contaminates sites, the average (mean) soil As is 15
mg/kg with a standard deviation of 2. Substituting this into the
Gaussian distribution formula:</p>
<pre class="r"><code>s &lt;- 2 # standard deviation
xmean &lt;-  15 #  mean
xval &lt;- seq(5, 25,by=0.5) # data
xval</code></pre>
<pre><code>##  [1]  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5 10.0 10.5 11.0 11.5 12.0
## [16] 12.5 13.0 13.5 14.0 14.5 15.0 15.5 16.0 16.5 17.0 17.5 18.0 18.5 19.0 19.5
## [31] 20.0 20.5 21.0 21.5 22.0 22.5 23.0 23.5 24.0 24.5 25.0</code></pre>
<p>No we can calculate Gaussian or normal distribution using above
formula.</p>
<pre class="r"><code>#  here we calculate a Gaussian distribution

yp &lt;- (1/(s*sqrt(2*pi)))*exp(1)^((-(xval-xmean)^2)/(2*s^2))

yp</code></pre>
<pre><code>##  [1] 7.433598e-07 2.514754e-06 7.991871e-06 2.385932e-05 6.691511e-05
##  [6] 1.762978e-04 4.363413e-04 1.014524e-03 2.215924e-03 4.546781e-03
## [11] 8.764150e-03 1.586983e-02 2.699548e-02 4.313866e-02 6.475880e-02
## [16] 9.132454e-02 1.209854e-01 1.505687e-01 1.760327e-01 1.933341e-01
## [21] 1.994711e-01 1.933341e-01 1.760327e-01 1.505687e-01 1.209854e-01
## [26] 9.132454e-02 6.475880e-02 4.313866e-02 2.699548e-02 1.586983e-02
## [31] 8.764150e-03 4.546781e-03 2.215924e-03 1.014524e-03 4.363413e-04
## [36] 1.762978e-04 6.691511e-05 2.385932e-05 7.991871e-06 2.514754e-06
## [41] 7.433598e-07</code></pre>
<pre class="r"><code>plot(xval,yp) </code></pre>
<p><img src="eda_files/figure-html/Plot%20Distribution-1.png" width="576" /></p>
<p>We can also get probability distribution using the command
<strong>dnorm()</strong> distribution</p>
<pre class="r"><code>dp  &lt;- dnorm(xval,xmean,s)    
plot(dp)</code></pre>
<p><img src="eda_files/figure-html/Probability%20Distribution-1.png" width="576" /></p>
<p>The distance from the mean of a particular measurement can be
discussed in terms of <strong>“deviations from the mean”</strong> as
multiples of the standard deviation. For instance:</p>
<ul>
<li><p>68.3% of measurements lie within plus or minus one standard
deviation</p></li>
<li><p>95.5% within plus or minus two standard deviations</p></li>
<li><p>99.7% within plus or minus three standard deviations.</p></li>
</ul>
<p>The R command for the cumulative distribution, which approaches 1, is
<strong>pnorm()</strong>:</p>
<pre class="r"><code>cdp &lt;-  pnorm(xval,xmean, s)
plot(cdp)</code></pre>
<img src="eda_files/figure-html/Cumulative%20Distribution-1.png" width="576" />
<div style="margin-bottom:20px;">

</div>
</div>
<div id="normal-distribution" class="section level4">
<h4><strong>Normal Distribution</strong></h4>
<p>Many of parametric statistical tests including correlation,
regression, t-test, and analysis of variance (ANOVA) require the data to
follow a <strong>normal distribution or Gaussian distribution</strong>.
The validity of these kind of tests depends on the distribution of the
data.</p>
<p>Before using a parametric test, some preliminary tests need to be
done to make sure that the test assumptions of <strong>“normal
distribution”</strong> of data are met. We’ll show how to check the
normality of the data by <strong>visual inspection</strong> and by
<strong>significance tests</strong>.</p>
<p>In this data frame, <strong>SAs</strong>, column represents the soil
total As (mg/kg) in paddy soils irrigated with As contaminated
groundwater from shallow depth. Let check the distribution of soil
As:</p>
<div style="margin-bottom:15px;">

</div>
</div>
<div id="visual-inspection-of-normal-distribution"
class="section level4">
<h4><strong>Visual Inspection of Normal Distribution</strong></h4>
<p>Here, we’ll describe how to check the normality of the data by visual
inspection by:</p>
<ul>
<li><p>Histogram</p></li>
<li><p>Kernel density Plots</p></li>
<li><p>Quantile-Quantile Plots</p></li>
</ul>
<div id="histogram" class="section level5">
<h5><strong>Histogram</strong></h5>
<p>You can create histograms with the function <strong>hist(x)</strong>
to visualize the distribution of a numeric vector (x). The option
freq=FALSE plots probability densities instead of frequencies. The
option breaks= controls the number of bins.</p>
<pre class="r"><code>hist(df$SAs, breaks = 20)</code></pre>
<img src="eda_files/figure-html/Histogram-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
<p>We can create a nice looking Barplot with <strong>ggplot2</strong>,
which install with <strong>tidyverse</strong></p>
<pre class="r"><code># Basic histogram
ggplot(df, aes(x=SAs)) + geom_histogram()</code></pre>
<p><img src="eda_files/figure-html/Histogram%20ggplot2-1.png" width="480" /></p>
<div style="margin-bottom:20px;">

</div>
<p>We can create a publication quality figure with ggplot2:</p>
<pre class="r"><code>p1&lt;-ggplot(df, aes(x=SAs)) + 
  # Change the width of bins and color
  geom_histogram(binwidth=1, color=&quot;black&quot;, fill=&quot;grey&quot;) +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #a. Histogram of Soil As&quot;)  +  
  xlab(&quot;Soil As (mg/kg)&quot;) + ylab(&quot;Frequency&quot;) +
  #  customized background and front size
  theme(
        panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
        axis.line = element_line(colour = &quot;grey&quot;),
        plot.title = element_text(size = 16, hjust = 0.5),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        axis.text.x=element_text(size=13, colour=&quot;black&quot;),
        axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))
  
print(p1)</code></pre>
<img src="eda_files/figure-html/Costom%20Histogram%20with%20ggplot2-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
</div>
<div id="kernel-density-plots" class="section level5">
<h5><strong>Kernel Density Plots</strong></h5>
<p><strong>Kernel density</strong> plots are usually a much more
effective way to view the distribution of a variable.</p>
<pre class="r"><code># Kernel Density Plot
d &lt;- density(df$SAs) # returns the density data
plot(d) # plots the results</code></pre>
<p><img src="eda_files/figure-html/Kernel%20Density-1.png" width="480" /></p>
<pre class="r"><code>summary(df$SAs)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    4.70   12.70   17.20   17.89   22.05   51.80</code></pre>
<p>With ggpplot2:</p>
<pre class="r"><code>p2&lt;- df %&gt;%
  ggplot(aes(x=SAs)) + 
  geom_density()+
  # Add median values of Soil As
  geom_vline(aes(xintercept=median(SAs)),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)+
  # set x and y data range
  scale_x_continuous(limits=c(0,60), breaks=seq(0, 60, 10))+ 
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #b: Density plot of Soil As)&quot;) +
  xlab(&quot;Soil As (mg/kg)&quot;) + ylab(&quot;Density&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))
print(p2)</code></pre>
<p><img src="eda_files/figure-html/Kernel%20density%20with%20ggplot2-1.png" width="480" /></p>
</div>
<div id="quantile-quantile-plots" class="section level5">
<h5><strong>Quantile-Quantile Plots</strong></h5>
<p><strong>qqnorm()</strong> is a generic function the default method of
which produces a normal QQ plot of the values in y.</p>
<p><strong>qqline()</strong> adds a line to a “theoretical”, by default
normal, quantile-quantile plot which passes through the probs quantiles,
by default the first and third quartiles.</p>
<pre class="r"><code>#create Q-Q plot to compare this dataset to a theoretical normal distribution
qqnorm(df$SAs)
qqline(df$SAs)</code></pre>
<p><img src="eda_files/figure-html/Quantile-Quantile%20Plots-1.png" width="480" /></p>
<p>With ggplot2:</p>
<pre class="r"><code>p3 &lt;- df %&gt;%
  ggplot(aes(sample = SAs)) +
  stat_qq() + 
  stat_qq_line() +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #c: QQ-plot of Soil As)&quot;) +
  xlab(&quot;Theoretical Quantiles)&quot;) + ylab(&quot;Sample Quantiles&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))
print (p3)</code></pre>
<p><img src="eda_files/figure-html/Quantile-Quantile%20Plots%20withh%20ggplot2-1.png" width="480" /></p>
<p>We can plot multiple figures in a panel using
<strong>gridExtra</strong> package</p>
<pre class="r"><code>grid.arrange(p1,p2,p3, ncol=3)</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-5-1.png" width="1152" /></p>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="visualization-of-normality-using-dlookr-package"
class="section level5">
<h5><strong>Visualization of Normality using dlookr
Package</strong></h5>
<p>We may also use <strong>plot_normality()</strong> function of
<strong>dlookr</strong> package to visualizes the normality of numeric
data. The information that plot_normality() visualizes is as
follows.</p>
<ul>
<li><p>Histogram of original data</p></li>
<li><p>Q-Q plot of original data</p></li>
<li><p>histogram of log transformed data</p></li>
<li><p>Histogram of square root transformed data</p></li>
</ul>
<div style="margin-bottom:20px;">

</div>
<pre class="r"><code>dlookr::plot_normality(df, SAs)</code></pre>
<p><img src="eda_files/figure-html/Plot%20Normality-1.png" width="672" /></p>
<div style="margin-bottom:20px;">

</div>
</div>
</div>
</div>
<div id="normality-test" class="section level3">
<h3><strong>Normality Test</strong></h3>
<p>The R-base function <strong>shapiro.test()</strong> from r-base
<strong>stats</strong> package can be used to perform the Shapiro-Wilk
test of normality for one variable (univariate):</p>
<pre class="r"><code>shapiro.test(df$SAs)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  df$SAs
## W = 0.93076, p-value = 9.513e-10</code></pre>
<p>From the above output, the p-value &lt; 0.05 implying that the
distribution of the Soil As are significantly different from normal
distribution. In other words, we can assume that Soil As is not-normally
distributed.</p>
<div style="margin-bottom:20px;">

</div>
<div id="test-of-normality-using-dlookr-package" class="section level4">
<h4><strong>Test of Normality using dlookr Package</strong></h4>
<p><strong>normality()</strong> function of <strong>dlookr</strong>
performs a normality test on multiple numerical data. Shapiro-Wilk
normality test is performed. When the number of observations is greater
than 5000, it is tested after extracting 5000 samples by random simple
sampling.</p>
<p>The variables of tbl_df object returned by normality() are as
follows.</p>
<ul>
<li><p>statistic : Statistics of the Shapiro-Wilk test</p></li>
<li><p>p_value : p-value of the Shapiro-Wilk test</p></li>
<li><p>sample : Number of sample observations performed Shapiro-Wilk
test</p></li>
</ul>
<pre class="r"><code>dlookr::normality(df, SAs, WAs, Grain_As)</code></pre>
<pre><code>## # A tibble: 3 × 4
##   vars     statistic       p_value sample
##   &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
## 1 SAs          0.940 0.00000000731    263
## 2 WAs          0.940 0.00000000731    263
## 3 Grain_As     0.940 0.00000000731    263</code></pre>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="measures-of-skewness-and-kurtosis" class="section level4">
<h4><strong>Measures of Skewness and Kurtosis</strong></h4>
<p><strong>Skewness</strong> measures the symmetry of the distribution
and this value can be positive or negative.</p>
<ul>
<li><p>A <strong>negative</strong> value indicates more values are
concentrated on the left side (tail) of the distribution. the most
frequent values are high; tail is toward low values (on the left-hand
side). Generally, Mode &gt; Median &gt; Mean.</p></li>
<li><p>A <strong>positive</strong> value indicates that the tail is on
the right side of the distribution. The most frequent values are low;
tail is toward the high values (on the right-hand side). Generally, Mode
&lt; Median &lt; Mean.</p></li>
<li><p>A value of <strong>zero</strong> indicates that there is no
skewness in the distribution at all, meaning the distribution is
perfectly symmetrical or normally distributed.</p></li>
</ul>
<p>To calculate the skewness and kurtosis of Soil As, we can use
<strong>skewness()</strong> and <strong>kurtosis()</strong> functions
from the <strong>moments</strong> library in R:</p>
<pre class="r"><code>moments::skewness(df$SAs)</code></pre>
<pre><code>## [1] 1.211611</code></pre>
<p>Positive values indicates, this indicates that the distribution is
right-skewed. This confirms what we have seen saw in the histogram and
density plots.</p>
<p><strong>Kurtosis</strong> is a measure of whether or not a
distribution is heavy-tailed or light-tailed relative to a normal
distribution. The kurtosis of a normal distribution is 3.</p>
<pre class="r"><code>moments::kurtosis(df$SAs)</code></pre>
<pre><code>## [1] 6.399313</code></pre>
<p>Since the kurtosis is &gt; 3, which indicates that the distribution
of Soil As has more values in the tails compared to a normal
distribution as we have seen in the QQ plots</p>
<p>The moments library also offers the <strong>jarque.test()</strong>
function, which performs a goodness-of-fit test that determines whether
or not sample data have skewness and kurtosis that matches a normal
distribution. The null and alternative hypotheses of this test are as
follows:</p>
<p><strong>Null Hypothesis</strong>: The dataset has a skewness and
kurtosis that matches a normal distribution.</p>
<p><strong>Alternative Hypothesis</strong>: The dataset has a skewness
and kurtosis that does not match a normal distribution.</p>
<pre class="r"><code>moments::jarque.test(df$SAs)</code></pre>
<pre><code>## 
##  Jarque-Bera Normality Test
## 
## data:  df$SAs
## JB = 190.97, p-value &lt; 2.2e-16
## alternative hypothesis: greater</code></pre>
<p>The p-value is found to be &lt; 0.05. We <strong>reject the null
hypothesis</strong>. We have sufficient evidence to say that this Soil
As has a skewness and kurtosis that is different from the normal
distribution</p>
<div style="margin-bottom:20px;">

</div>
<p><strong>find_skewness()</strong> of <strong>dlookr</strong> package
searches for variables with skewed data. This function finds data skewed
by search conditions and calculates skewness.</p>
<pre class="r"><code>## Calculation of skewness
df %&gt;% dplyr::select(SAs, WAs, Grain_As) %&gt;% 
 dlookr::find_skewness(value = TRUE)</code></pre>
<pre><code>##      SAs      WAs Grain_As 
##    1.212    0.977    1.114</code></pre>
<p>We van also compute the skewness &amp; filtering with threshold</p>
<pre class="r"><code>df %&gt;% dplyr::select(SAs, WAs, Grain_As) %&gt;% 
 dlookr::find_skewness(value = TRUE, thres =1)</code></pre>
<pre><code>##      SAs Grain_As 
##    1.212    1.114</code></pre>
<div style="margin-bottom:15px;">

</div>
</div>
</div>
<div id="data-transformation-for-normality" class="section level3">
<h3><strong>Data Transformation for Normality</strong></h3>
<p>In statistical data analysis, transformation is the replacement of
one variable by one function of that variable: for example, replacing
one variable x by the square root or by the logarithm of x. The
transformation is a replacement that changes the shape of a distribution
or relationship.</p>
<p>There are many reasons for transformation (source: <a
href="http://fmwww.bc.edu/repec/bocode/t/transint.html"
class="uri">http://fmwww.bc.edu/repec/bocode/t/transint.html</a>)</p>
<pre><code>1. Reducing skewness or transforming Data for Normality
2. Equal spreads
3. Linear relationships
4. Additive relationships</code></pre>
<div id="data-transformation-methods" class="section level4">
<h4><strong>Data Transformation Methods</strong></h4>
<p>In this section, you will get a brief overview of these three
transformation techniques and when to use them.</p>
<p><strong>Square Root Transformation</strong></p>
<p>The square root method is typically used when your data is moderately
skewed. Now using the square root (e.g., sqrt(x)) is a transformation
that has a moderate effect on distribution shape. It is generally used
to reduce right skewed data. Finally, the square root can be applied on
zero values and is most commonly used on counted data.</p>
<ul>
<li><p>sqrt(x) for positively skewed data,</p></li>
<li><p>sqrt(max(x+1) - x) for negatively skewed data</p></li>
</ul>
<p><strong>Power Transformation</strong></p>
<p>a power transform is a family of functions that are applied to create
a monotonic transformation of data using power functions.</p>
<p><strong>Log Transformation</strong> is a strong transformation that
has a major effect on distribution shape. This technique is, as the
square root method, oftenly used for reducing right skewness. Worth
noting, however, is that it can not be applied to zero or negative
values.</p>
<ul>
<li><p>log10(x) for positively skewed data,</p></li>
<li><p>log10(max(x+1) - x) for negatively skewed data</p></li>
</ul>
<p>The <strong>Box-Cox transformation</strong> use a suitable exponent
(Lambda = l) to transform skewed data.</p>
<p><strong>transform()</strong> function of *dlookr<strong> performs
data both </strong>Standardization** and transform data for
normalization (resolve skewness).</p>
<ul>
<li><p><strong>Standardization</strong></p>
<ul>
<li><p>“zscore” : z-score transformation. (x - mu) / sigma</p></li>
<li><p>“minmax” : minmax transformation. (x - min) / (max -
min)</p></li>
</ul></li>
<li><p><strong>Resolving Skewness</strong></p>
<ul>
<li><p>“log” : log transformation. log(x)</p></li>
<li><p>“log+1” : log transformation. log(x + 1). Used for values that
contain 0.</p></li>
<li><p>“sqrt” : square root transformation.</p></li>
<li><p>“1/x” : 1 / x transformation</p></li>
<li><p>“x^3” : x^3 square transformation</p></li>
</ul></li>
</ul>
<pre class="r"><code>df$logSAs = dlookr::transform(df$SAs, method = &quot;log&quot;)</code></pre>
<pre class="r"><code># summary of transformation
summary(df$logSAs)</code></pre>
<pre><code>## * Resolving Skewness with log
## 
## * Information of Transformation (before vs after)
##             Original Transformation
## n        263.0000000   263.00000000
## na         0.0000000     0.00000000
## mean      17.8869962     2.80041699
## sd         7.3877135     0.41906961
## se_mean    0.4555459     0.02584094
## IQR        9.3500000     0.55173904
## skewness   1.2185725    -0.35448139
## kurtosis   3.4880000     0.31839421
## p00        4.7000000     1.54756251
## p01        5.6240000     1.72689330
## p05        7.8200000     2.05665551
## p10        9.4200000     2.24282611
## p20       11.5400000     2.44581026
## p25       12.7000000     2.54157099
## p30       13.6000000     2.61006979
## p40       15.7800000     2.75874009
## p50       17.2000000     2.84490938
## p60       18.6000000     2.92316158
## p70       20.2640000     3.00884486
## p75       22.0500000     3.09331003
## p80       23.5000000     3.15700042
## p90       26.5000000     3.27714473
## p95       29.0600000     3.36935407
## p99       46.0500000     3.82938344
## p100      51.8000000     3.94739015</code></pre>
<pre class="r"><code>plot(df$logSAs)</code></pre>
<img src="eda_files/figure-html/Plot-1.png" width="672" />
<div style="margin-bottom:15px;">

</div>
</div>
<div id="power-transformation" class="section level4">
<h4><strong>Power Transformation</strong></h4>
<p>Power Transform uses the maximum likelihood-like approach of Box and
Cox (1964) to select a transformation of a univariate or multivariate
response for normality.</p>
<p>The following expression gives the Box-Cox functions transformations
for various values of lambda:</p>
<img src="Image/PNG_FILE_02/boxcox.png" width="40%" style="display: block; margin: auto auto auto 0;" />
<div style="margin-bottom:20px;">

</div>
<p>First we have to calculate appropriate transformation parameters
using <strong>powerTransform()</strong> function of <strong>car</strong>
package and then use this parameter to transform the data using
<strong>bcPower()</strong> function.</p>
<pre class="r"><code>car::powerTransform(df$SAs)</code></pre>
<pre><code>## Estimated transformation parameter 
##    df$SAs 
## 0.2605306</code></pre>
<pre class="r"><code>df$SAs.bc&lt;-car::bcPower(df$SAs, 0.2605306)</code></pre>
<pre class="r"><code>p4&lt;-ggplot(df, aes(x=SAs.bc)) + 
  # Change the width of bins and color
  geom_histogram(binwidth=0.5, color=&quot;black&quot;, fill=&quot;grey&quot;) +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #b. Histogram of Box-Cox Transformed Soil As&quot;)  +  
  xlab(&quot;Transformed Soil As&quot;) + ylab(&quot;Frequency&quot;) +
  #  customized background and front size
  theme(
        panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
        axis.line = element_line(colour = &quot;grey&quot;),
        plot.title = element_text(size = 16, hjust = 0.5),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        axis.text.x=element_text(size=13, colour=&quot;black&quot;),
        axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))
  
print(p4)</code></pre>
<p><img src="eda_files/figure-html/Histogram%20of%20ransformed%20Data-1.png" width="480" /></p>
<pre class="r"><code>grid.arrange(p1, p4, ncol=2)</code></pre>
<img src="eda_files/figure-html/unnamed-chunk-8-1.png" width="960" />
<div style="margin-bottom:20px;">

</div>
</div>
</div>
<div id="descriptive-statistics" class="section level3">
<h3><strong>Descriptive Statistics</strong></h3>
<p>Descriptive statistics are used to describe the basic features of the
data in a study. They provide simple summaries about the sample and the
measures. Together with simple graphics analysis, they form the basis of
virtually every quantitative analysis of data.</p>
<p>We use <strong>describe()</strong> function from
<strong>dloookr</strong> package to computes descriptive statistics for
numerical data. The descriptive statistics help determine the
distribution of numerical variables. L</p>
<p>The variables of the tbl_df object returned by describe() are as
follows.</p>
<ul>
<li><p>n : number of observations excluding missing values</p></li>
<li><p>na : number of missing values</p></li>
<li><p>mean : arithmetic average</p></li>
<li><p>sd : standard deviation</p></li>
<li><p>se_mean : standard error mean. sd/sqrt(n)</p></li>
<li><p>IQR : interquartile range (Q3-Q1)</p></li>
<li><p>skewness : skewness</p></li>
<li><p>kurtosis : kurtosis</p></li>
<li><p>p25 : Q1. 25% percentile</p></li>
<li><p>p50 : median. 50% percentile</p></li>
<li><p>p75 : Q3. 75% percentile</p></li>
<li><p>p01, p05, p10, p20, p30 : 1%, 5%, 20%, 30% percentiles</p></li>
<li><p>p40, p60, p70, p80 : 40%, 60%, 70%, 80% percentiles</p></li>
<li><p>p90, p95, p99, p100 : 90%, 95%, 99%, 100% percentiles</p></li>
</ul>
<pre class="r"><code>des.stat&lt;-dlookr::describe(df, SAs, WAs, Grain_As)
datatable(as.data.frame(des.stat), 
          rownames = T, options = list(pageLength = 10, scrollX = TRUE, round)) %&gt;%
  formatRound(columns = 2:23, digits = 3)</code></pre>
<div id="htmlwidget-f0645a2cffc8089964a2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f0645a2cffc8089964a2">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["SAs","WAs","Grain_As"],[263,263,263],[0,0,0],[17.8869961977186,0.129882129277567,0.32574144486692],[7.38771347633234,0.0792438343980487,0.120027198225798],[0.455545928318471,0.00488638415932393,0.00740119410618795],[9.35,0.1005,0.14],[1.21857250919683,0.982413821266386,1.12028618235355],[3.48800001115879,1.50149565435886,2.75972845961381],[4.7,0.011,0.094],[5.624,0.01486,0.11854],[7.82,0.0201,0.1603],[9.42,0.035,0.1794],[11.54,0.0608,0.229],[12.7,0.0745,0.245],[13.6,0.0816,0.2616],[15.78,0.0998,0.292],[17.2,0.119,0.313],[18.6,0.1374,0.3366],[20.264,0.166,0.369],[22.05,0.175,0.385],[23.5,0.1852,0.407],[26.5,0.2318,0.4706],[29.06,0.258,0.5238],[46.05,0.36898,0.733299999999999],[51.8,0.458,0.845]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>described_variables<\/th>\n      <th>n<\/th>\n      <th>na<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>se_mean<\/th>\n      <th>IQR<\/th>\n      <th>skewness<\/th>\n      <th>kurtosis<\/th>\n      <th>p00<\/th>\n      <th>p01<\/th>\n      <th>p05<\/th>\n      <th>p10<\/th>\n      <th>p20<\/th>\n      <th>p25<\/th>\n      <th>p30<\/th>\n      <th>p40<\/th>\n      <th>p50<\/th>\n      <th>p60<\/th>\n      <th>p70<\/th>\n      <th>p75<\/th>\n      <th>p80<\/th>\n      <th>p90<\/th>\n      <th>p95<\/th>\n      <th>p99<\/th>\n      <th>p100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":22,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":23,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render","options.columnDefs.21.render"],"jsHooks":[]}</script>
<p>The <strong>describe()</strong> function supports the
<strong>group_by()</strong> function syntax of the
<strong>dplyr</strong> package. Following function calculate descriptive
testatrices of Soil, Water and Grain As of diffrent landtypes</p>
<pre class="r"><code>stat.landtype&lt;-df %&gt;%
            group_by(Land_type) %&gt;% 
            dlookr::describe(SAs, WAs, Grain_As)

datatable(as.data.frame(stat.landtype), 
          rownames = T, options = list(pageLength = 10, scrollX = TRUE, round)) %&gt;%
  formatRound(columns = 3:19, digits = 3)</code></pre>
<div id="htmlwidget-be42b82339977298ff37" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-be42b82339977298ff37">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["Grain_As","Grain_As","SAs","SAs","WAs","WAs"],["HL","MHL","HL","MHL","HL","MHL"],[122,141,122,141,122,141],[0,0,0,0,0,0],[0.304868852459016,0.343801418439716,14.0938524590164,21.1690070921986,0.112860655737705,0.144609929078014],[0.126505541695469,0.111449169698769,5.33950727394064,7.35606788450038,0.077281102816012,0.0782241991284069],[0.0114532735959122,0.00938571323630871,0.48341627454567,0.619492670042772,0.00699670229843622,0.00658766595698778],[0.15525,0.115,7.425,7.6,0.13275,0.085],[1.02820664949231,1.48255855062447,0.604088179672109,1.51350717452661,0.827539224564074,1.22391828477293],[1.87979680549277,4.35384479635621,0.0261696183069651,4.39631670146602,1.70912336355007,1.3343333875457],[0.094,0.151,4.7,5.7,0.011,0.032],[0.09931,0.1576,4.947,9.84,0.01221,0.0366],[0.14415,0.202,6.705,11.6,0.01705,0.053],[0.1643,0.224,7.82,13.1,0.02,0.064],[0.1922,0.26,9.32,15.9,0.035,0.082],[0.22025,0.273,9.775,16.8,0.04125,0.092],[0.2299,0.289,10.86,17.4,0.053,0.097],[0.2614,0.311,12,18.3,0.0772,0.107],[0.2925,0.323,13.6,20,0.116,0.122],[0.3126,0.353,15.06,22.4,0.1314,0.145],[0.3477,0.373,16.6,23.8,0.1634,0.166],[0.3755,0.388,17.2,24.4,0.174,0.177],[0.4012,0.409,18.228,26.1,0.1818,0.2],[0.4655,0.481,21.227,28.7,0.2063,0.252],[0.5021,0.531,24.13,31.6,0.22665,0.306],[0.65806,0.762999999999999,27.858,50,0.27191,0.3736],[0.829,0.845,28.2,51.8,0.458,0.427]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>described_variables<\/th>\n      <th>Land_type<\/th>\n      <th>n<\/th>\n      <th>na<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>se_mean<\/th>\n      <th>IQR<\/th>\n      <th>skewness<\/th>\n      <th>kurtosis<\/th>\n      <th>p00<\/th>\n      <th>p01<\/th>\n      <th>p05<\/th>\n      <th>p10<\/th>\n      <th>p20<\/th>\n      <th>p25<\/th>\n      <th>p30<\/th>\n      <th>p40<\/th>\n      <th>p50<\/th>\n      <th>p60<\/th>\n      <th>p70<\/th>\n      <th>p75<\/th>\n      <th>p80<\/th>\n      <th>p90<\/th>\n      <th>p95<\/th>\n      <th>p99<\/th>\n      <th>p100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render"],"jsHooks":[]}</script>
<div style="margin-bottom:15px;">

</div>
</div>
<div id="boxplots" class="section level3">
<h3><strong>Boxplots</strong></h3>
<p>In descriptive statistics, a box plot or boxplot is a method for
graphically depicting groups of numerical data through their quartiles.
Box plots may also have lines extending from the boxes indicating
variability outside the upper and lower quartiles, hence the terms
box-and-whisker plot and box-and-whisker diagram (Wikepedia)</p>
<img src="Image/PNG_FILE_02/boxplot.png" width="80%" style="display: block; margin: auto;" />
<div style="margin-bottom:20px;">

</div>
<ul>
<li><p>median (Q2/50th Percentile): the middle value of the
dataset.</p></li>
<li><p>first quartile (Q1/25th Percentile): the middle number between
the smallest number (not the “minimum”) and the median of the
dataset.</p></li>
<li><p>third quartile (Q3/75th Percentile): the middle value between the
median and the highest value (not the “maximum”) of the
dataset.</p></li>
<li><p>interquartile range (IQR): 25th to the 75th percentile.</p></li>
<li><p>whiskers (shown in blue)</p></li>
<li><p>outliers (shown as green circles)</p></li>
<li><p>maximum: Q3 + 1.5*IQR</p></li>
<li><p>minimum: Q1 -1.5*IQR</p></li>
</ul>
<p>source: <a
href="https://towardsdatascience.com/understanding-boxplots-5e2df7bcbd51"
class="uri">https://towardsdatascience.com/understanding-boxplots-5e2df7bcbd51</a></p>
<pre class="r"><code># add mean to ggplot2 boxplot
p5&lt;-ggplot(df, aes(x = Land_type, y = SAs, fill = Land_type)) + 
  geom_boxplot() +
  # Show mean values  
  stat_summary(fun = &quot;mean&quot;, geom = &quot;point&quot;, shape = 8,
               size = 2, color = &quot;white&quot;) +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #: Boxplot of  Soil As&quot;) +
  xlab(&quot;Landtype&quot;) + ylab(&quot;Soil As (mg/kg)&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;),
    legend.position = &quot;none&quot;)
print (p5)</code></pre>
<img src="eda_files/figure-html/Boxplots-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
<div id="grouped-boxplots" class="section level4">
<h4><strong>Grouped Boxplots</strong></h4>
<p>A grouped boxplot is a boxplot where categories are organized in
groups and subgroups. Here we visualize the distribution of of As in six
rice varieties and 2 landtyes</p>
<pre class="r"><code># grouped boxplot
ggplot(df, aes(x=Variety, y=Grain_As, fill=Land_type)) + 
    geom_boxplot()+
   #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #: Boxplot of  Rice Grain As&quot;) +
  xlab(&quot;Rice Variety&quot;) + ylab(&quot;Grain As (mg/kg)&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;)) +
   # add legend tittle
  guides(fill = guide_legend(title = &quot;Landtypes&quot;))</code></pre>
<img src="eda_files/figure-html/Grouped%20Boxplots-1.png" width="576" />
<div style="margin-bottom:20px;">

</div>
</div>
<div id="boxplots-with-jitter" class="section level4">
<h4><strong>Boxplots with Jitter</strong></h4>
<p>gplot2 can add another variables (Water As) on top of boxplots (Soil
As) using <strong>geom_jitter()</strong> function. This function shifts
all dots by a random value ranging from 0 to size, avoiding overlaps. We
can</p>
<pre class="r"><code>rgb.palette &lt;- colorRampPalette(c(&quot;red&quot;, &quot;yellow&quot;, &quot;green&quot;, &quot;blue&quot;,&quot;sky blue&quot;)) 

ggplot(df, aes(y=SAs, x=Land_type))+
         geom_point(aes(colour=WAs),size = I(1.5),
            position=position_jitter(width=0.05, height=0.05)) +
        geom_boxplot(fill=NA, outlier.colour=NA)+
        scale_y_continuous(limits=c(0,60), breaks=seq(0, 60, 10)) +
        ggtitle(&quot;Figure #: Box and Jitter plot of Soil As with Water As&quot;) +
        xlab(&quot;&quot;) + ylab(&quot;Soil As (mg/kg)&quot;) +
        coord_flip()+
        theme_light() +
        theme(
              plot.title = element_text(color=&quot;black&quot;, size=14,hjust = 0.5),
              panel.background = element_rect(fill = &quot;gray95&quot;,
                                          colour = &quot;gray75&quot;,
                                          size = 0.5, linetype = &quot;solid&quot;),
              axis.line = element_line(colour = &quot;grey&quot;),
              panel.grid.major = element_blank(),
              axis.text.y=element_text(size=10,angle = 0,vjust = 0, hjust=0.5),
              axis.text.x = element_text(size=14),
              axis.title.x = element_text(size=14),
              axis.title.y = element_text(size=14),
              legend.text = element_text(size = 10),legend.title = element_text(size = 14),
              legend.background = element_rect(fill=&quot;transparent&quot;, 
                                        size=0.5, linetype=&quot;solid&quot;))+
              scale_colour_gradientn(name=&quot;Water As(mg/kg)&quot;, colours =rgb.palette(14))</code></pre>
<img src="eda_files/figure-html/Boxplots%20with%20Jitter-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
</div>
</div>
<div id="barplot" class="section level3">
<h3><strong>Barplot</strong></h3>
<div id="barplot-with-error-bars" class="section level4">
<h4><strong>Barplot with Error Bars</strong></h4>
<pre class="r"><code>df %&gt;%
  # Calculate descriptive statistic group by Landtype
  group_by(Land_type) %&gt;% 
  dlookr::describe(SAs) %&gt;% 
  # Create bar plot mean Soil As
  ggplot(aes(x=Land_type, y=mean,fill= Land_type)) +
  geom_bar(stat=&quot;identity&quot;, position=position_dodge(),width=0.3) +
  # add standard error of mean as error bars 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,  position=position_dodge(.9)) +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #: Barplot  of Mean ± SD of Soil As&quot;) +
  xlab(&quot;Landtype&quot;) + ylab(&quot;Soil As (mg/kg)&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;),
    legend.position = &quot;none&quot;)</code></pre>
<img src="eda_files/figure-html/Barplots%20with%20Error%20Bars-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
</div>
<div id="grouped-barplot-with-error-bars" class="section level4">
<h4><strong>Grouped Barplot with Error Bars</strong></h4>
<p>First, check descriptive statistics of grain As of six rice varieties
in two landtypes:</p>
<pre class="r"><code>stat.variety&lt;-df %&gt;%
            group_by(Variety, Land_type) %&gt;% 
            dlookr::describe(Grain_As) 

datatable(as.data.frame(stat.variety), 
          rownames = T, options = list(pageLength = 12, scrollX = TRUE, round)) %&gt;%
  formatRound(columns = 4:19, digits = 3)</code></pre>
<div id="htmlwidget-f689dd4f8b82339db479" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f689dd4f8b82339db479">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],["Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As","Grain_As"],["BR28","BR28","BR29","BR29","IET","IET","Minikate","Minikate","Purbachi","Purbachi","Ratna","Ratna"],["HL","MHL","HL","MHL","HL","MHL","HL","MHL","HL","MHL","HL","MHL"],[31,53,3,4,31,50,9,10,24,14,24,10],[0,0,0,0,0,0,0,0,0,0,0,0],[0.282903225806452,0.338943396226415,0.474333333333333,0.44725,0.400677419354839,0.3709,0.395555555555556,0.4007,0.221041666666667,0.251,0.238125,0.2657],[0.062283413971249,0.0637110107300444,0.175377687672444,0.138939735137217,0.142244715683167,0.135768447838853,0.0710318786023415,0.130708369195617,0.0969192757633524,0.0710893262571274,0.0833756885115956,0.0764097870403756],[0.0111864313775648,0.00875138036361988,0.10125435518754,0.0694698675686085,0.0255479051219879,0.019200558027605,0.0236772928674472,0.0413336155904341,0.0197835643216922,0.0189994216221974,0.0170189911505532,0.0241628962576003],[0.072,0.075,0.174,0.16225,0.173,0.12775,0.059,0.17375,0.11275,0.07675,0.10175,0.066],[0.621184732320598,0.0170525564847106,0.636462340496375,-0.992136230305842,0.729798944682443,1.61015828454195,0.914291990713648,0.996568469103182,1.0772751931278,0.57930575875748,0.810363585887112,1.19775590498684],[1.13255303616117,0.393897255730755,null,-0.251307836881828,1.63108324524672,3.70589124851485,1.38353844748856,1.16485356680897,1.00024711932984,-0.697923475502177,0.354290097794368,3.18559603873781],[0.164,0.179,0.313,0.261,0.144,0.163,0.294,0.246,0.094,0.154,0.108,0.151],[0.1724,0.19564,0.31572,0.26586,0.1509,0.16839,0.298,0.24987,0.09469,0.15517,0.11306,0.15694],[0.194,0.2258,0.3266,0.2853,0.1935,0.22485,0.314,0.26535,0.1012,0.15985,0.1345,0.1807],[0.211,0.274,0.3402,0.3096,0.232,0.2458,0.334,0.2847,0.1292,0.1741,0.1621,0.2104],[0.233,0.2978,0.3674,0.3582,0.294,0.264,0.3554,0.2914,0.1488,0.2012,0.1728,0.2186],[0.2435,0.306,0.381,0.3825,0.2975,0.29025,0.363,0.293,0.156,0.20225,0.17675,0.22125],[0.256,0.3156,0.3946,0.4068,0.301,0.3021,0.3662,0.2948,0.158,0.2029,0.1806,0.2253],[0.266,0.32,0.4218,0.4458,0.374,0.3204,0.3736,0.3554,0.1706,0.2216,0.1996,0.2466],[0.283,0.336,0.449,0.48,0.403,0.349,0.384,0.4025,0.194,0.231,0.229,0.2645],[0.293,0.3462,0.4914,0.5142,0.442,0.3698,0.384,0.4156,0.2242,0.2604,0.2348,0.2748],[0.309,0.3624,0.5338,0.5401,0.466,0.3853,0.4068,0.4411,0.2413,0.2738,0.2608,0.2841],[0.3155,0.381,0.555,0.54475,0.4705,0.418,0.422,0.46675,0.26875,0.279,0.2785,0.28725],[0.321,0.3886,0.5762,0.5494,0.479,0.455,0.4364,0.4832,0.297,0.3098,0.3108,0.291],[0.344,0.4264,0.6186,0.5587,0.512,0.5256,0.4744,0.511,0.3378,0.36,0.3477,0.3134],[0.385,0.447,0.6398,0.56335,0.629,0.56985,0.5072,0.5965,0.38575,0.3665,0.3718,0.3782],[0.4434,0.47696,0.65676,0.56707,0.7744,0.83128,0.53344,0.6649,0.46407,0.3717,0.43221,0.43004],[0.453,0.491,0.661,0.568,0.829,0.845,0.54,0.682,0.485,0.373,0.449,0.443]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>described_variables<\/th>\n      <th>Variety<\/th>\n      <th>Land_type<\/th>\n      <th>n<\/th>\n      <th>na<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>se_mean<\/th>\n      <th>IQR<\/th>\n      <th>skewness<\/th>\n      <th>kurtosis<\/th>\n      <th>p00<\/th>\n      <th>p01<\/th>\n      <th>p05<\/th>\n      <th>p10<\/th>\n      <th>p20<\/th>\n      <th>p25<\/th>\n      <th>p30<\/th>\n      <th>p40<\/th>\n      <th>p50<\/th>\n      <th>p60<\/th>\n      <th>p70<\/th>\n      <th>p75<\/th>\n      <th>p80<\/th>\n      <th>p90<\/th>\n      <th>p95<\/th>\n      <th>p99<\/th>\n      <th>p100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"scrollX":true,"columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render"],"jsHooks":[]}</script>
<div style="margin-bottom:20px;">

</div>
<pre class="r"><code>df %&gt;%
  # Calculate descriptive statistic group by rice variety
  group_by(Variety, Land_type) %&gt;% 
  dlookr::describe(Grain_As) %&gt;% 
  # Create bar plot mean Soil As
  ggplot(aes(x=Variety, y=mean,fill= Land_type)) +
  geom_bar(stat=&quot;identity&quot;, position=position_dodge(),width=0.3) +
  # add standard error of mean as error bars 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, colour = &quot;gray75&quot;, position=position_dodge(.4)) +
  #Change the Plot title and axis labels 
  ggtitle(&quot;Barplot of Mean ± SD of Rice Grain As in two Landtypes &quot;) +
  xlab(&quot;Rice variety&quot;) + ylab(&quot;Rice Grain  As (mg/kg)&quot;) +
  # Flip the bars
  coord_flip()+
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 14, hjust = 0.5),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))+
    # add legend tittle
    guides(fill = guide_legend(title = &quot;Landtypes&quot;))</code></pre>
<img src="eda_files/figure-html/Grouped%20Barplots%20with%20Error%20Bars-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
</div>
<div id="stacked-barplot" class="section level4">
<h4><strong>Stacked Barplot</strong></h4>
<p>A stacked barplot is very similar to the grouped barplot. The
subgroups are just displayed on top of each other, not beside. The only
thing to change to get this figure is to switch the
<strong>position</strong> argument to <strong>stack</strong>.</p>
<pre class="r"><code>df %&gt;%
  # Calculate descriptive statistic group by rice variety
  group_by(Variety) %&gt;% 
  dlookr::describe(Grain_As, Straw_As) %&gt;% 
   # Create bar plot mean Soil As
  ggplot(aes(x=Variety, y=mean,fill= described_variables)) +
  geom_bar(stat=&quot;identity&quot;, position=&quot;stack&quot;)+
  #Change the Plot title and axis labels 
  ggtitle(&quot;Barplot of Mean As in Rice Grain and Straw&quot;) +
  xlab(&quot;Rice variety&quot;) + ylab(&quot;Rice As (mg/kg)&quot;) +
  # Flip the bars
  coord_flip()+
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 14, hjust = 0.5),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))+
    # add legend tittle
    guides(fill = guide_legend(title = &quot;&quot;))</code></pre>
<img src="eda_files/figure-html/Stacked%20Barplot-1.png" width="480" />
<div style="margin-bottom:20px;">

</div>
</div>
</div>
<div id="grouped-density-plot" class="section level3">
<h3><strong>Grouped Density Plot</strong></h3>
<pre class="r"><code>df %&gt;%
  ggplot(aes(x=SAs, color=Land_type)) + 
  geom_density(alpha = 0.5) +
  # set x and y data range
  scale_x_continuous(limits=c(0,60), breaks=seq(0, 60, 10))+ 
  #Change the Plot title and axis labels 
  ggtitle(&quot;Figure #b: Density Plot of Soil As group by Landtypes&quot;) +
  xlab(&quot;Soil As (mg/kg)&quot;) + ylab(&quot;Density&quot;) +
  theme(
    panel.background = element_rect(fill = &quot;grey95&quot;,colour = &quot;gray75&quot;,size = 0.5, linetype = &quot;solid&quot;),
    axis.line = element_line(colour = &quot;grey&quot;),
    plot.title = element_text(size = 16, hjust = 0.5),
    axis.title.x = element_text(size = 16),
    axis.title.y = element_text(size = 16),
    axis.text.x=element_text(size=13, colour=&quot;black&quot;),
    axis.text.y=element_text(size=13,angle = 90,vjust = 0.5, hjust=0.5, colour=&#39;black&#39;))+
  # add legend tittle
  guides(color = guide_legend(title = &quot;Landtypes&quot;))</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-12-1.png" width="528" /></p>
<div style="margin-bottom:20px;">

</div>
</div>
<div id="further-reading" class="section level3">
<h3><strong>Further Reading</strong></h3>
<ol style="list-style-type: decimal">
<li><a href="https://github.com/choonghyunryu/dlookr">dlook</a></li>
</ol>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
